/* 容器：穿透鼠标，层级最高，GPU加速 */
#st-ambient-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 2147483647;
    overflow: hidden;
    transform: translateZ(0); /* 强制开启硬件加速 */
}

/* 粒子通用样式 */
.ambient-particle {
    position: absolute;
    top: -50px;
    /* 发光效果 */
    filter: drop-shadow(0 0 5px currentColor);
    /* 告诉浏览器这些属性要变，提前优化 */
    will-change: transform, opacity;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

/* --- 形状定义 --- */
.shape-snow { border-radius: 50%; background-color: currentColor; }
.shape-star { background-color: currentColor; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); }
.shape-leaf { background-color: currentColor; border-radius: 0 50% 0 50%; }
.shape-flower { background-color: currentColor; border-radius: 50% 50% 0 50%; }

/* --- 关键帧：三种不同的飘落轨迹，模拟自然风 --- */

/* 轨迹1：S型摇摆 (左右摆动) */
@keyframes fall-sway-1 {
    0% { transform: translate3d(0, 0, 0) rotate(0deg); opacity: 0; }
    25% { transform: translate3d(50px, 25vh, 0) rotate(90deg); opacity: 1; }
    50% { transform: translate3d(-50px, 50vh, 0) rotate(180deg); }
    75% { transform: translate3d(25px, 75vh, 0) rotate(270deg); }
    100% { transform: translate3d(0, 110vh, 0) rotate(360deg); opacity: 0.3; }
}

/* 轨迹2：向右飘逝 (大风吹) */
@keyframes fall-sway-2 {
    0% { transform: translate3d(0, 0, 0) rotate(0deg); opacity: 0; }
    30% { transform: translate3d(30px, 30vh, 0) rotate(45deg); opacity: 1; }
    100% { transform: translate3d(150px, 110vh, 0) rotate(180deg); opacity: 0.3; }
}

/* 轨迹3：向左回旋 (落叶感) */
@keyframes fall-sway-3 {
    0% { transform: translate3d(0, 0, 0) rotate(0deg); opacity: 0; }
    40% { transform: translate3d(-60px, 40vh, 0) rotate(-60deg); opacity: 1; }
    100% { transform: translate3d(-20px, 110vh, 0) rotate(-120deg); opacity: 0.3; }
}

/* --- 菜单样式 (保持不变) --- */
.ambient-settings-box { padding: 0 5px; width: 100%; background: transparent; border: none; }
.ambient-desc { font-size: 12px; opacity: 0.6; margin: 5px 0 10px 0; text-align: center; font-style: italic; color: var(--SmartThemeBodyColor); }
.ambient-control-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; font-size: 14px; color: var(--SmartThemeBodyColor); border-bottom: 1px solid var(--SmartThemeBorderColor); }
.ambient-control-row:last-child { border-bottom: none; }
.ambient-control-row label { flex: 1; font-weight: 500; }
.ambient-control-row input, .ambient-control-row select { flex: 1; max-width: 50%; cursor: pointer; }
