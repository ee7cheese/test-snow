/* 容器：穿透鼠标，层级最高 */
#st-ambient-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 2147483647;
    overflow: hidden;
    /* 启用 GPU 硬件加速通道 */
    transform: translateZ(0);
}

/* 粒子基础样式 */
.ambient-particle {
    position: absolute;
    top: -50px; /* 起始点在屏幕外 */
    /* 关键：使用 drop-shadow 实现发光，比 box-shadow 性能更好且适配异形 */
    filter: drop-shadow(0 0 5px currentColor);
    /* 开启 GPU 独立图层，杜绝卡顿 */
    will-change: transform;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

/* --- 形状定义 (纯 CSS 绘制，拒绝 Emoji) --- */

/* 1. 雪花 (圆形) */
.shape-snow {
    border-radius: 50%;
    background-color: currentColor;
}

/* 2. 星星 (四角星/十字星) */
.shape-star {
    background-color: currentColor;
    /* 裁剪出星星形状 */
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
}

/* 3. 树叶 (圆角矩形) */
.shape-leaf {
    background-color: currentColor;
    border-radius: 0 50% 0 50%;
}

/* 4. 花瓣 (复杂心形/花形) */
.shape-flower {
    background-color: currentColor;
    /* 简单的五瓣花裁剪逻辑太复杂，这里用圆角模拟花瓣 */
    border-radius: 50% 50% 0 50%;
    transform: rotate(45deg);
}

/* --- 动画关键帧 --- */
@keyframes ambient-fall {
    0% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    100% {
        transform: translateY(110vh) translateX(20px) rotate(360deg);
        opacity: 0.3;
    }
}

/* --- 菜单样式 (保持原生风格) --- */
.ambient-settings-box {
    padding: 0 5px;
    width: 100%;
    background: transparent;
    border: none;
}
.ambient-desc {
    font-size: 12px; opacity: 0.6; margin: 5px 0 10px 0;
    text-align: center; font-style: italic; color: var(--SmartThemeBodyColor);
}
.ambient-control-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 0; font-size: 14px; color: var(--SmartThemeBodyColor);
    border-bottom: 1px solid var(--SmartThemeBorderColor);
}
.ambient-control-row:last-child { border-bottom: none; }
.ambient-control-row label { flex: 1; font-weight: 500; }
.ambient-control-row input, .ambient-control-row select {
    flex: 1; max-width: 50%; cursor: pointer;
}
